# Rectangle Matrix FP16 Performance Benchmarks

Performance measured on AMD Radeon RX 7900 GRE, WSL2 Ubuntu 22.04.5 LTS, ROCm 6.4.2 in TFLOPs.

## FP16-FP16 Performance Results

| Matrix Size    | Input Layout (A,B) | `rocm_wmma_gemm`<br>(C=col) | `rocBLAS`<br>(C=col) | Ratio<br>(C=col / rocBLAS) | `rocm_wmma_gemm`<br>(C=row) | Ratio<br>(C=row / rocBLAS) |
|:---------------|:-------------------|---------------------------:|--------------------:|--------------------------:|---------------------------:|--------------------------:|
| 2048x5120x5120 | col, col |                      66.82 |               72.64 |                      0.92 |                      67.36 |                      0.93 |
| 2048x5120x5120 | row, col |                      59.03 |               33.42 |                      1.77 |                      60.72 |                      1.82 |
| 2048x5120x5120 | col, row |                      80.12 |               75.65 |                      1.06 |                      83.26 |                      1.10 |
| 2048x5120x5120 | row, row |                      81.17 |               77.11 |                      1.05 |                      82.60 |                      1.07 |
| 4096x2048x64 | col, col |                       9.63 |               11.45 |                      0.84 |                      10.82 |                      0.95 |
| 4096x2048x64 | row, col |                       9.28 |               11.47 |                      0.81 |                       9.25 |                      0.81 |
| 4096x2048x64 | col, row |                       9.70 |               11.34 |                      0.86 |                       9.92 |                      0.87 |
| 4096x2048x64 | row, row |                       8.75 |               10.98 |                      0.80 |                      11.35 |                      1.03 |
| 4096x4096x1024 | col, col |                      57.60 |               66.61 |                      0.86 |                      62.83 |                      0.94 |
| 4096x4096x1024 | row, col |                      44.17 |               37.26 |                      1.19 |                      46.52 |                      1.25 |
| 4096x4096x1024 | col, row |                      64.88 |               70.75 |                      0.92 |                      68.27 |                      0.96 |
| 4096x4096x1024 | row, row |                      60.27 |               68.54 |                      0.88 |                      67.98 |                      0.99 |
| 4096x4096x16384 | col, col |                      65.49 |               52.15 |                      1.26 |                      66.19 |                      1.27 |
| 4096x4096x16384 | row, col |                      39.73 |               25.06 |                      1.59 |                      39.73 |                      1.59 |
| 4096x4096x16384 | col, row |                      75.26 |               55.33 |                      1.36 |                      74.82 |                      1.35 |
| 4096x4096x16384 | row, row |                      70.00 |               41.94 |                      1.67 |                      71.36 |                      1.70 |
| 4096x5120x5120 | col, col |                      70.60 |               64.51 |                      1.09 |                      71.48 |                      1.11 |
| 4096x5120x5120 | row, col |                      66.27 |               37.62 |                      1.76 |                      68.69 |                      1.83 |
| 4096x5120x5120 | col, row |                      81.19 |               76.01 |                      1.07 |                      85.55 |                      1.13 |
| 4096x5120x5120 | row, row |                      81.41 |               74.99 |                      1.09 |                      84.34 |                      1.12 |
| 4096x16384x4096 | col, col |                      70.93 |               60.18 |                      1.18 |                      72.26 |                      1.20 |
| 4096x16384x4096 | row, col |                      51.28 |               33.95 |                      1.51 |                      51.19 |                      1.51 |
| 4096x16384x4096 | col, row |                      78.84 |               75.94 |                      1.04 |                      79.98 |                      1.05 |
| 4096x16384x4096 | row, row |                      70.08 |               50.00 |                      1.40 |                      73.53 |                      1.47 |
| 8192x4096x128 | col, col |                      32.07 |               42.41 |                      0.76 |                      38.64 |                      0.91 |
| 8192x4096x128 | row, col |                      32.00 |               39.72 |                      0.81 |                      38.07 |                      0.96 |
| 8192x4096x128 | col, row |                      29.01 |               38.27 |                      0.76 |                      39.63 |                      1.04 |
| 8192x4096x128 | row, row |                      26.89 |               42.98 |                      0.63 |                      38.97 |                      0.91 |
| 8192x8192x1024 | col, col |                      61.97 |               71.01 |                      0.87 |                      67.06 |                      0.94 |
| 8192x8192x1024 | row, col |                      57.32 |               47.05 |                      1.22 |                      60.07 |                      1.28 |
| 8192x8192x1024 | col, row |                      72.51 |               74.83 |                      0.97 |                      75.76 |                      1.01 |
| 8192x8192x1024 | row, row |                      58.25 |               70.96 |                      0.82 |                      74.57 |                      1.05 |
| 32768x4096x4096 | col, col |                      72.04 |               73.92 |                      0.97 |                      75.12 |                      1.02 |
| 32768x4096x4096 | row, col |                      54.09 |               33.33 |                      1.62 |                      53.39 |                      1.60 |
| 32768x4096x4096 | col, row |                      77.72 |               75.27 |                      1.03 |                      79.52 |                      1.06 |
| 32768x4096x4096 | row, row |                      75.66 |               54.99 |                      1.38 |                      78.86 |                      1.43 |
| 65536x2048x2048 | col, col |                      67.46 |               65.43 |                      1.03 |                      73.66 |                      1.13 |
| 65536x2048x2048 | row, col |                      54.01 |               28.96 |                      1.86 |                      54.06 |                      1.87 |
| 65536x2048x2048 | col, row |                      74.98 |               60.95 |                      1.23 |                      77.81 |                      1.28 |
| 65536x2048x2048 | row, row |                      68.45 |               46.74 |                      1.46 |                      75.42 |                      1.61 |