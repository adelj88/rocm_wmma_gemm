# Matrix Performance Benchmarks

Performance measured on AMD Radeon RX 7900 GRE on WSL2 (Ubuntu 24.04.1 LTS, ROCm 6.3.4) in TFLOPs.

| Matrix Size       | Input Layout (A,B) | `rocm_wmma_gemm`<br>(C=col) | `rocBLAS`<br>(C=col) | Ratio<br>(C=col / rocBLAS) | `rocm_wmma_gemm`<br>(C=row) | Ratio<br>(C=row / rocBLAS) |
|:------------------|:-------------------|---------------------------:|--------------------:|--------------------------:|---------------------------:|--------------------------:|
| 4096×4096×1024    | col, col           |                      48.50 |               68.55 |                      0.71 |                      50.56 |                      0.74 |
| 4096×4096×1024    | row, col           |                      39.48 |               35.33 |                      1.12 |                      41.04 |                      1.16 |
| 4096×4096×1024    | col, row           |                      54.22 |               74.18 |                      0.73 |                      57.93 |                      0.78 |
| 4096×4096×1024    | row, row           |                      49.16 |               70.41 |                      0.70 |                      52.44 |                      0.74 |
| 8192×8192×1024    | col, col           |                      62.75 |               72.02 |                      0.87 |                      65.37 |                      0.91 |
| 8192×8192×1024    | row, col           |                      57.10 |               47.76 |                      1.20 |                      59.39 |                      1.24 |
| 8192×8192×1024    | col, row           |                      69.91 |               76.60 |                      0.91 |                      74.45 |                      0.97 |
| 8192×8192×1024    | row, row           |                      65.05 |               72.24 |                      0.90 |                      68.74 |                      0.95 |
| 4096×2048×64      | col, col           |                       7.50 |               11.68 |                      0.64 |                       9.32 |                      0.80 |
| 4096×2048×64      | row, col           |                       7.79 |               11.76 |                      0.66 |                       8.88 |                      0.75 |
| 4096×2048×64      | col, row           |                       7.94 |               11.69 |                      0.68 |                       9.49 |                      0.81 |
| 4096×2048×64      | row, row           |                       7.64 |               11.53 |                      0.66 |                       9.23 |                      0.80 |
| 8192×4096×128     | col, col           |                      23.75 |               43.87 |                      0.54 |                      32.01 |                      0.73 |
| 8192×4096×128     | row, col           |                      24.79 |               40.89 |                      0.61 |                      31.23 |                      0.76 |
| 8192×4096×128     | col, row           |                      25.24 |               42.58 |                      0.59 |                      32.94 |                      0.77 |
| 8192×4096×128     | row, row           |                      25.01 |               43.45 |                      0.58 |                      30.99 |                      0.71 |
| 4096×16384×4096   | col, col           |                      47.92 |               60.56 |                      0.79 |                      49.40 |                      0.82 |
| 4096×16384×4096   | row, col           |                      42.88 |               33.39 |                      1.28 |                      42.50 |                      1.27 |
| 4096×16384×4096   | col, row           |                      74.76 |               78.30 |                      0.95 |                      78.67 |                      1.00 |
| 4096×16384×4096   | row, row           |                      71.04 |               51.04 |                      1.39 |                      73.58 |                      1.44 |
| 4096×4096×16384   | col, col           |                      61.26 |               52.53 |                      1.17 |                      57.99 |                      1.10 |
| 4096×4096×16384   | row, col           |                      40.50 |               25.34 |                      1.60 |                      41.47 |                      1.64 |
| 4096×4096×16384   | col, row           |                      68.57 |               54.23 |                      1.26 |                      70.02 |                      1.29 |
| 4096×4096×16384   | row, row           |                      62.93 |               42.52 |                      1.48 |                      63.71 |                      1.50 |
| 2048×5120×5120    | col, col           |                      71.90 |               73.19 |                      0.98 |                      71.19 |                      0.97 |
| 2048×5120×5120    | row, col           |                      51.97 |               33.21 |                      1.56 |                      52.03 |                      1.57 |
| 2048×5120×5120    | col, row           |                      81.92 |               77.03 |                      1.06 |                      85.11 |                      1.10 |
| 2048×5120×5120    | row, row           |                      78.28 |               78.17 |                      1.00 |                      78.22 |                      1.00 |
| 4096×5120×5120    | col, col           |                      77.33 |               64.24 |                      1.20 |                      74.42 |                      1.16 |
| 4096×5120×5120    | row, col           |                      59.97 |               37.61 |                      1.60 |                      60.60 |                      1.61 |
| 4096×5120×5120    | col, row           |                      84.04 |               77.03 |                      1.09 |                      86.65 |                      1.12 |
| 4096×5120×5120    | row, row           |                      81.48 |               76.05 |                      1.07 |                      82.37 |                      1.08 |
| 32768×4096×4096   | col, col           |                      71.20 |               76.44 |                      0.93 |                      69.19 |                      0.91 |
| 32768×4096×4096   | row, col           |                      59.08 |               33.64 |                      1.76 |                      60.83 |                      1.81 |
| 32768×4096×4096   | col, row           |                      78.24 |               77.91 |                      1.00 |                      81.04 |                      1.04 |
| 32768×4096×4096   | row, row           |                      70.32 |               55.99 |                      1.26 |                      75.19 |                      1.34 |
| 65536×2048×2048   | col, col           |                      66.95 |               67.34 |                      0.99 |                      66.15 |                      0.98 |
| 65536×2048×2048   | row, col           |                      56.84 |               29.44 |                      1.93 |                      57.03 |                      1.94 |
| 65536×2048×2048   | col, row           |                      74.18 |               61.47 |                      1.21 |                      77.71 |                      1.26 |
| 65536×2048×2048   | row, row           |                      65.90 |               48.10 |                      1.37 |                      69.67 |                      1.45 |
