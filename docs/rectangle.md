# Rectangle Matrix FP16 Performance Benchmarks

Performance measured on AMD Radeon RX 7900 GRE, WSL2 Ubuntu 22.04.5 LTS, ROCm 6.4.2 in TFLOPs.

## FP16-FP16 Performance Results

| Matrix Size    | Input Layout (A,B) | `rocm_wmma_gemm`<br>(C=col) | `rocBLAS`<br>(C=col) | Ratio<br>(C=col / rocBLAS) | `rocm_wmma_gemm`<br>(C=row) | Ratio<br>(C=row / rocBLAS) |
|:---------------|:-------------------|---------------------------:|--------------------:|--------------------------:|---------------------------:|--------------------------:|
| 2048x5120x5120 | col, col |                      64.68 |               69.70 |                      0.93 |                      66.09 |                      0.95 |
| 2048x5120x5120 | row, col |                      57.99 |               30.47 |                      1.90 |                      59.56 |                      1.95 |
| 2048x5120x5120 | col, row |                      80.38 |               76.16 |                      1.06 |                      84.83 |                      1.11 |
| 2048x5120x5120 | row, row |                      81.68 |               76.09 |                      1.07 |                      83.60 |                      1.10 |
| 4096x2048x64 | col, col |                      10.01 |               12.39 |                      0.81 |                      10.85 |                      0.88 |
| 4096x2048x64 | row, col |                      10.12 |               12.33 |                      0.82 |                      10.67 |                      0.87 |
| 4096x2048x64 | col, row |                      10.26 |               12.30 |                      0.83 |                      11.49 |                      0.93 |
| 4096x2048x64 | row, row |                       9.97 |               11.86 |                      0.84 |                      12.07 |                      1.02 |
| 4096x4096x1024 | col, col |                      56.98 |               66.51 |                      0.86 |                      62.36 |                      0.94 |
| 4096x4096x1024 | row, col |                      43.60 |               35.19 |                      1.24 |                      45.54 |                      1.29 |
| 4096x4096x1024 | col, row |                      64.25 |               70.46 |                      0.91 |                      68.13 |                      0.97 |
| 4096x4096x1024 | row, row |                      59.38 |               68.21 |                      0.87 |                      68.30 |                      1.00 |
| 4096x4096x16384 | col, col |                      64.23 |               48.29 |                      1.33 |                      64.53 |                      1.34 |
| 4096x4096x16384 | row, col |                      38.46 |               23.08 |                      1.67 |                      38.28 |                      1.66 |
| 4096x4096x16384 | col, row |                      74.46 |               49.06 |                      1.52 |                      74.80 |                      1.52 |
| 4096x4096x16384 | row, row |                      69.90 |               38.60 |                      1.81 |                      71.48 |                      1.85 |
| 4096x5120x5120 | col, col |                      71.25 |               56.19 |                      1.27 |                      71.38 |                      1.27 |
| 4096x5120x5120 | row, col |                      64.20 |               34.28 |                      1.87 |                      68.47 |                      2.00 |
| 4096x5120x5120 | col, row |                      83.17 |               76.22 |                      1.09 |                      86.38 |                      1.13 |
| 4096x5120x5120 | row, row |                      82.77 |               74.78 |                      1.11 |                      84.98 |                      1.14 |
| 4096x16384x4096 | col, col |                      70.37 |               55.25 |                      1.27 |                      72.95 |                      1.32 |
| 4096x16384x4096 | row, col |                      46.96 |               30.33 |                      1.55 |                      46.93 |                      1.55 |
| 4096x16384x4096 | col, row |                      78.76 |               76.22 |                      1.03 |                      79.92 |                      1.05 |
| 4096x16384x4096 | row, row |                      69.54 |               48.43 |                      1.44 |                      73.79 |                      1.52 |
| 8192x4096x128 | col, col |                      31.80 |               43.93 |                      0.72 |                      39.00 |                      0.89 |
| 8192x4096x128 | row, col |                      32.48 |               41.69 |                      0.78 |                      39.21 |                      0.94 |
| 8192x4096x128 | col, row |                      32.10 |               42.50 |                      0.76 |                      39.91 |                      0.94 |
| 8192x4096x128 | row, row |                      26.84 |               43.19 |                      0.62 |                      43.60 |                      1.01 |
| 8192x8192x1024 | col, col |                      61.48 |               71.37 |                      0.86 |                      67.73 |                      0.95 |
| 8192x8192x1024 | row, col |                      57.44 |               46.54 |                      1.23 |                      59.37 |                      1.28 |
| 8192x8192x1024 | col, row |                      71.64 |               75.23 |                      0.95 |                      76.12 |                      1.01 |
| 8192x8192x1024 | row, row |                      58.19 |               70.62 |                      0.82 |                      74.74 |                      1.06 |
| 32768x4096x4096 | col, col |                      68.95 |               73.36 |                      0.94 |                      69.42 |                      0.95 |
| 32768x4096x4096 | row, col |                      49.89 |               30.67 |                      1.63 |                      49.53 |                      1.61 |
| 32768x4096x4096 | col, row |                      77.85 |               78.66 |                      0.99 |                      79.74 |                      1.01 |
| 32768x4096x4096 | row, row |                      75.67 |               51.86 |                      1.46 |                      78.93 |                      1.52 |
| 65536x2048x2048 | col, col |                      66.38 |               65.92 |                      1.01 |                      68.90 |                      1.05 |
| 65536x2048x2048 | row, col |                      49.82 |               26.21 |                      1.90 |                      49.87 |                      1.90 |
| 65536x2048x2048 | col, row |                      74.97 |               53.68 |                      1.40 |                      78.29 |                      1.46 |
| 65536x2048x2048 | row, row |                      68.27 |               43.29 |                      1.58 |                      75.00 |                      1.73 |