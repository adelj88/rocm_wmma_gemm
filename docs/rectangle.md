# Matrix Performance Benchmarks

Performance measured on AMD Radeon RX 7900 GRE on WSL2 (Ubuntu 24.04.1 LTS, ROCm 6.3.4) in TFLOPs.

| Matrix Size       | Input Layout (A,B) | `rocm_wmma_gemm`<br>(C=col) | `rocBLAS`<br>(C=col) | Ratio<br>(C=col / rocBLAS) | `rocm_wmma_gemm`<br>(C=row) | Ratio<br>(C=row / rocBLAS) |
|:------------------|:-------------------|---------------------------:|--------------------:|--------------------------:|---------------------------:|--------------------------:|
| 4096×4096×1024    | col, col           |                      52.80 |               66.46 |                      0.79 |                      57.25 |                      0.86 |
| 4096×4096×1024    | row, col           |                      38.97 |               35.37 |                      1.10 |                      40.26 |                      1.14 |
| 4096×4096×1024    | col, row           |                      60.82 |               69.64 |                      0.87 |                      64.23 |                      0.92 |
| 4096×4096×1024    | row, row           |                      54.12 |               67.01 |                      0.81 |                      59.45 |                      0.89 |
| 8192×8192×1024    | col, col           |                      62.80 |               71.91 |                      0.87 |                      66.06 |                      0.92 |
| 8192×8192×1024    | row, col           |                      57.28 |               47.54 |                      1.20 |                      58.75 |                      1.24 |
| 8192×8192×1024    | col, row           |                      69.64 |               76.51 |                      0.91 |                      75.00 |                      0.98 |
| 8192×8192×1024    | row, row           |                      65.35 |               72.29 |                      0.90 |                      69.55 |                      0.96 |
| 4096×2048×64      | col, col           |                       7.91 |                9.45 |                      0.84 |                       8.84 |                      0.94 |
| 4096×2048×64      | row, col           |                       7.86 |                8.31 |                      0.95 |                       8.77 |                      1.06 |
| 4096×2048×64      | col, row           |                       8.47 |                8.55 |                      0.99 |                       9.30 |                      1.09 |
| 4096×2048×64      | row, row           |                       7.86 |                8.89 |                      0.88 |                       8.67 |                      0.98 |
| 8192×4096×128     | col, col           |                      27.73 |               43.52 |                      0.64 |                      34.99 |                      0.80 |
| 8192×4096×128     | row, col           |                      29.55 |               30.23 |                      0.98 |                      35.21 |                      1.16 |
| 8192×4096×128     | col, row           |                      27.33 |               34.39 |                      0.79 |                      36.41 |                      1.06 |
| 8192×4096×128     | row, row           |                      29.19 |               41.15 |                      0.71 |                      36.42 |                      0.89 |
| 4096×16384×4096   | col, col           |                      47.73 |               60.28 |                      0.79 |                      46.70 |                      0.77 |
| 4096×16384×4096   | row, col           |                      42.33 |               33.82 |                      1.25 |                      42.99 |                      1.27 |
| 4096×16384×4096   | col, row           |                      75.48 |               77.48 |                      0.97 |                      79.84 |                      1.03 |
| 4096×16384×4096   | row, row           |                      70.80 |               51.11 |                      1.39 |                      75.85 |                      1.48 |
| 4096×4096×16384   | col, col           |                      61.22 |               52.40 |                      1.17 |                      61.22 |                      1.17 |
| 4096×4096×16384   | row, col           |                      39.03 |               25.17 |                      1.55 |                      39.96 |                      1.59 |
| 4096×4096×16384   | col, row           |                      71.19 |               52.84 |                      1.35 |                      72.70 |                      1.38 |
| 4096×4096×16384   | row, row           |                      65.78 |               42.25 |                      1.56 |                      65.16 |                      1.54 |
| 2048×5120×5120    | col, col           |                      70.11 |               72.92 |                      0.96 |                      71.10 |                      0.97 |
| 2048×5120×5120    | row, col           |                      52.01 |               33.36 |                      1.56 |                      55.59 |                      1.67 |
| 2048×5120×5120    | col, row           |                      79.34 |               76.67 |                      1.03 |                      82.31 |                      1.07 |
| 2048×5120×5120    | row, row           |                      77.89 |               78.15 |                      1.00 |                      80.80 |                      1.03 |
| 4096×5120×5120    | col, col           |                      74.28 |               64.26 |                      1.16 |                      75.36 |                      1.17 |
| 4096×5120×5120    | row, col           |                      59.13 |               37.80 |                      1.56 |                      59.59 |                      1.58 |
| 4096×5120×5120    | col, row           |                      84.61 |               77.49 |                      1.09 |                      86.98 |                      1.12 |
| 4096×5120×5120    | row, row           |                      79.88 |               76.03 |                      1.05 |                      83.09 |                      1.09 |
| 32768×4096×4096   | col, col           |                      69.82 |               76.48 |                      0.91 |                      70.26 |                      0.92 |
| 32768×4096×4096   | row, col           |                      57.89 |               33.69 |                      1.72 |                      59.97 |                      1.78 |
| 32768×4096×4096   | col, row           |                      78.93 |               77.85 |                      1.01 |                      81.00 |                      1.04 |
| 32768×4096×4096   | row, row           |                      71.33 |               56.05 |                      1.27 |                      76.49 |                      1.36 |
| 65536×2048×2048   | col, col           |                      66.66 |               67.74 |                      0.98 |                      67.78 |                      1.00 |
| 65536×2048×2048   | row, col           |                      56.50 |               29.34 |                      1.93 |                      56.72 |                      1.93 |
| 65536×2048×2048   | col, row           |                      75.23 |               62.09 |                      1.21 |                      78.97 |                      1.27 |
| 65536×2048×2048   | row, row           |                      66.98 |               47.71 |                      1.40 |                      71.89 |                      1.51 |
