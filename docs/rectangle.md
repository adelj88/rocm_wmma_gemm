# Matrix Performance Benchmarks

Performance measured on AMD Radeon RX 7900 GRE on WSL2 (Ubuntu 24.04.1 LTS, ROCm 6.3.4) in TFLOPs.

| Matrix Size       | Input Layout (A,B) | `rocm_wmma_gemm`<br>(C=col) | `rocBLAS`<br>(C=col) | Ratio<br>(C=col / rocBLAS) | `rocm_wmma_gemm`<br>(C=row) | Ratio<br>(C=row / rocBLAS) |
|:------------------|:-------------------|---------------------------:|--------------------:|--------------------------:|---------------------------:|--------------------------:|
| 4096×4096×1024    | col, col           |                      48.55 |               68.35 |                      0.71 |                      51.50 |                      0.75 |
| 4096×4096×1024    | row, col           |                      39.75 |               36.76 |                      1.08 |                      41.41 |                      1.13 |
| 4096×4096×1024    | col, row           |                      54.13 |               73.73 |                      0.73 |                      58.23 |                      0.79 |
| 4096×4096×1024    | row, row           |                      50.98 |               68.69 |                      0.74 |                      55.10 |                      0.80 |
| 8192×8192×1024    | col, col           |                      62.75 |               72.21 |                      0.87 |                      66.11 |                      0.92 |
| 8192×8192×1024    | row, col           |                      57.09 |               47.47 |                      1.20 |                      59.20 |                      1.25 |
| 8192×8192×1024    | col, row           |                      69.97 |               76.94 |                      0.91 |                      74.43 |                      0.97 |
| 8192×8192×1024    | row, row           |                      65.44 |               71.83 |                      0.91 |                      69.92 |                      0.97 |
| 4096×2048×64      | col, col           |                       8.22 |               11.58 |                      0.71 |                       9.32 |                      0.80 |
| 4096×2048×64      | row, col           |                       8.28 |                9.77 |                      0.85 |                       9.58 |                      0.98 |
| 4096×2048×64      | col, row           |                       8.26 |               10.74 |                      0.77 |                       9.75 |                      0.91 |
| 4096×2048×64      | row, row           |                       8.22 |               10.64 |                      0.77 |                       9.82 |                      0.92 |
| 8192×4096×128     | col, col           |                      25.53 |               42.88 |                      0.60 |                      32.55 |                      0.76 |
| 8192×4096×128     | row, col           |                      25.32 |               40.27 |                      0.63 |                      32.30 |                      0.80 |
| 8192×4096×128     | col, row           |                      25.61 |               39.57 |                      0.65 |                      33.94 |                      0.86 |
| 8192×4096×128     | row, row           |                      25.40 |               40.68 |                      0.62 |                      33.90 |                      0.83 |
| 4096×16384×4096   | col, col           |                      47.94 |               60.49 |                      0.79 |                      47.24 |                      0.78 |
| 4096×16384×4096   | row, col           |                      42.89 |               33.92 |                      1.26 |                      42.48 |                      1.25 |
| 4096×16384×4096   | col, row           |                      74.55 |               77.79 |                      0.96 |                      78.31 |                      1.01 |
| 4096×16384×4096   | row, row           |                      69.84 |               50.81 |                      1.37 |                      74.54 |                      1.47 |
| 4096×4096×16384   | col, col           |                      58.54 |               52.81 |                      1.11 |                      58.25 |                      1.10 |
| 4096×4096×16384   | row, col           |                      40.50 |               25.24 |                      1.60 |                      41.57 |                      1.65 |
| 4096×4096×16384   | col, row           |                      68.63 |               54.51 |                      1.26 |                      69.76 |                      1.28 |
| 4096×4096×16384   | row, row           |                      62.95 |               42.43 |                      1.48 |                      64.67 |                      1.52 |
| 2048×5120×5120    | col, col           |                      72.30 |               73.11 |                      0.99 |                      72.66 |                      0.99 |
| 2048×5120×5120    | row, col           |                      52.33 |               33.19 |                      1.58 |                      51.91 |                      1.56 |
| 2048×5120×5120    | col, row           |                      81.94 |               78.01 |                      1.05 |                      84.49 |                      1.08 |
| 2048×5120×5120    | row, row           |                      80.09 |               78.07 |                      1.03 |                      82.35 |                      1.05 |
| 4096×5120×5120    | col, col           |                      75.86 |               64.76 |                      1.17 |                      75.88 |                      1.17 |
| 4096×5120×5120    | row, col           |                      59.72 |               37.90 |                      1.58 |                      61.01 |                      1.61 |
| 4096×5120×5120    | col, row           |                      84.02 |               76.72 |                      1.10 |                      86.72 |                      1.13 |
| 4096×5120×5120    | row, row           |                      80.08 |               76.60 |                      1.05 |                      82.80 |                      1.08 |
| 32768×4096×4096   | col, col           |                      69.29 |               76.18 |                      0.91 |                      69.88 |                      0.92 |
| 32768×4096×4096   | row, col           |                      58.95 |               33.57 |                      1.76 |                      60.65 |                      1.81 |
| 32768×4096×4096   | col, row           |                      78.54 |               78.36 |                      1.00 |                      80.90 |                      1.03 |
| 32768×4096×4096   | row, row           |                      70.05 |               55.96 |                      1.25 |                      75.93 |                      1.36 |
| 65536×2048×2048   | col, col           |                      65.56 |               67.22 |                      0.98 |                      66.62 |                      0.99 |
| 65536×2048×2048   | row, col           |                      56.72 |               29.49 |                      1.92 |                      57.02 |                      1.93 |
| 65536×2048×2048   | col, row           |                      74.10 |               61.16 |                      1.21 |                      77.76 |                      1.27 |
| 65536×2048×2048   | row, row           |                      66.27 |               47.98 |                      1.38 |                      70.79 |                      1.48 |
