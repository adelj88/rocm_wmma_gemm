# Matrix Performance Benchmarks

Performance measured on AMD Radeon RX 7900 GRE on WSL2 (Ubuntu 24.04.1 LTS, ROCm 6.4.1) in TFLOPs.

| Matrix Size       | Input Layout (A,B) | `rocm_wmma_gemm`<br>(C=col) | `rocBLAS`<br>(C=col) | Ratio<br>(C=col / rocBLAS) | `rocm_wmma_gemm`<br>(C=row) | Ratio<br>(C=row / rocBLAS) |
|:------------------|:-------------------|---------------------------:|--------------------:|--------------------------:|---------------------------:|--------------------------:|
| 4096×4096×1024    | col, col           |                      58.79 |               66.21 |                      0.89 |                      62.03 |                      0.94 |
| 4096×4096×1024    | row, col           |                      41.36 |               34.81 |                      1.19 |                      42.99 |                      1.24 |
| 4096×4096×1024    | col, row           |                      60.34 |               70.21 |                      0.86 |                      65.92 |                      0.94 |
| 4096×4096×1024    | row, row           |                      58.84 |               68.30 |                      0.86 |                      64.70 |                      0.95 |
| 8192×8192×1024    | col, col           |                      63.03 |               71.32 |                      0.88 |                      64.80 |                      0.91 |
| 8192×8192×1024    | row, col           |                      57.26 |               46.73 |                      1.23 |                      58.91 |                      1.26 |
| 8192×8192×1024    | col, row           |                      68.67 |               75.00 |                      0.92 |                      74.78 |                      1.00 |
| 8192×8192×1024    | row, row           |                      58.88 |               70.72 |                      0.83 |                      73.24 |                      1.04 |
| 4096×2048×64      | col, col           |                       8.82 |               11.75 |                      0.75 |                      10.68 |                      0.91 |
| 4096×2048×64      | row, col           |                       8.70 |               11.62 |                      0.75 |                      10.48 |                      0.90 |
| 4096×2048×64      | col, row           |                       9.19 |               11.41 |                      0.81 |                      11.29 |                      0.99 |
| 4096×2048×64      | row, row           |                       9.10 |               11.57 |                      0.79 |                      11.20 |                      0.97 |
| 8192×4096×128     | col, col           |                      25.27 |               44.47 |                      0.57 |                      36.58 |                      0.82 |
| 8192×4096×128     | row, col           |                      26.08 |               41.04 |                      0.64 |                      37.93 |                      0.92 |
| 8192×4096×128     | col, row           |                      26.55 |               41.97 |                      0.63 |                      39.76 |                      0.95 |
| 8192×4096×128     | row, row           |                      27.20 |               42.82 |                      0.64 |                      40.66 |                      0.95 |
| 4096×16384×4096   | col, col           |                      59.38 |               55.38 |                      1.07 |                      66.26 |                      1.20 |
| 4096×16384×4096   | row, col           |                      45.00 |               30.44 |                      1.48 |                      44.64 |                      1.47 |
| 4096×16384×4096   | col, row           |                      76.44 |               76.45 |                      1.00 |                      77.83 |                      1.02 |
| 4096×16384×4096   | row, row           |                      68.72 |               47.94 |                      1.43 |                      71.66 |                      1.49 |
| 4096×4096×16384   | col, col           |                      61.17 |               48.18 |                      1.27 |                      60.79 |                      1.26 |
| 4096×4096×16384   | row, col           |                      38.69 |               22.75 |                      1.70 |                      38.52 |                      1.69 |
| 4096×4096×16384   | col, row           |                      73.30 |               47.82 |                      1.53 |                      74.82 |                      1.56 |
| 4096×4096×16384   | row, row           |                      69.03 |               38.80 |                      1.78 |                      68.60 |                      1.77 |
| 2048×5120×5120    | col, col           |                      66.87 |               69.91 |                      0.96 |                      70.24 |                      1.00 |
| 2048×5120×5120    | row, col           |                      56.19 |               30.50 |                      1.84 |                      57.98 |                      1.90 |
| 2048×5120×5120    | col, row           |                      77.57 |               75.51 |                      1.03 |                      81.69 |                      1.08 |
| 2048×5120×5120    | row, row           |                      75.46 |               75.45 |                      1.00 |                      79.32 |                      1.05 |
| 4096×5120×5120    | col, col           |                      72.16 |               58.96 |                      1.22 |                      74.45 |                      1.26 |
| 4096×5120×5120    | row, col           |                      59.97 |               34.38 |                      1.74 |                      61.71 |                      1.79 |
| 4096×5120×5120    | col, row           |                      81.50 |               75.66 |                      1.08 |                      85.19 |                      1.13 |
| 4096×5120×5120    | row, row           |                      77.14 |               74.22 |                      1.04 |                      80.21 |                      1.08 |
| 32768×4096×4096   | col, col           |                      67.40 |               74.49 |                      0.90 |                      71.48 |                      0.96 |
| 32768×4096×4096   | row, col           |                      54.27 |               30.60 |                      1.77 |                      55.15 |                      1.80 |
| 32768×4096×4096   | col, row           |                      76.81 |               76.72 |                      1.00 |                      80.73 |                      1.05 |
| 32768×4096×4096   | row, row           |                      72.00 |               52.76 |                      1.36 |                      75.80 |                      1.44 |
| 65536×2048×2048   | col, col           |                      68.91 |               65.17 |                      1.06 |                      70.00 |                      1.07 |
| 65536×2048×2048   | row, col           |                      50.74 |               26.66 |                      1.90 |                      53.28 |                      2.00 |
| 65536×2048×2048   | col, row           |                      73.16 |               56.03 |                      1.31 |                      78.29 |                      1.40 |
| 65536×2048×2048   | row, row           |                      64.17 |               46.38 |                      1.38 |                      71.10 |                      1.53 |
