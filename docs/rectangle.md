# Matrix Performance Benchmarks

Performance measured on AMD Radeon RX 7900 GRE on WSL2 (Ubuntu 24.04.1 LTS, ROCm 6.3.4) in TFLOPs.

| Matrix Size       | Input Layout (A,B) | `rocm_wmma_gemm`<br>(C=col) | `rocBLAS`<br>(C=col) | Ratio<br>(C=col / rocBLAS) | `rocm_wmma_gemm`<br>(C=row) | Ratio<br>(C=row / rocBLAS) |
|:------------------|:-------------------|---------------------------:|--------------------:|--------------------------:|---------------------------:|--------------------------:|
| 4096×4096×1024    | col, col           |                      52.41 |               66.84 |                      0.78 |                      55.75 |                      0.83 |
| 4096×4096×1024    | row, col           |                      39.36 |               36.00 |                      1.09 |                      43.61 |                      1.21 |
| 4096×4096×1024    | col, row           |                      61.15 |               71.76 |                      0.85 |                      64.06 |                      0.89 |
| 4096×4096×1024    | row, row           |                      53.93 |               67.72 |                      0.80 |                      58.56 |                      0.86 |
| 8192×8192×1024    | col, col           |                      62.76 |               71.45 |                      0.88 |                      66.41 |                      0.93 |
| 8192×8192×1024    | row, col           |                      57.88 |               47.67 |                      1.21 |                      60.12 |                      1.26 |
| 8192×8192×1024    | col, row           |                      69.82 |               76.10 |                      0.92 |                      74.05 |                      0.97 |
| 8192×8192×1024    | row, row           |                      65.23 |               72.04 |                      0.91 |                      69.33 |                      0.96 |
| 4096×2048×64      | col, col           |                       8.12 |                9.23 |                      0.88 |                       9.06 |                      0.98 |
| 4096×2048×64      | row, col           |                       8.31 |                9.10 |                      0.91 |                       8.57 |                      0.94 |
| 4096×2048×64      | col, row           |                       8.24 |                8.96 |                      0.92 |                       8.60 |                      0.96 |
| 4096×2048×64      | row, row           |                       8.07 |                9.24 |                      0.87 |                       9.04 |                      0.98 |
| 8192×4096×128     | col, col           |                      27.94 |               42.62 |                      0.66 |                      35.30 |                      0.83 |
| 8192×4096×128     | row, col           |                      29.04 |               34.13 |                      0.85 |                      35.99 |                      1.05 |
| 8192×4096×128     | col, row           |                      28.50 |               35.69 |                      0.80 |                      35.86 |                      1.00 |
| 8192×4096×128     | row, row           |                      28.87 |               40.85 |                      0.71 |                      35.87 |                      0.88 |
| 4096×16384×4096   | col, col           |                      59.17 |               60.27 |                      0.98 |                      60.21 |                      1.00 |
| 4096×16384×4096   | row, col           |                      45.14 |               33.59 |                      1.34 |                      42.77 |                      1.27 |
| 4096×16384×4096   | col, row           |                      75.02 |               78.64 |                      0.95 |                      79.65 |                      1.01 |
| 4096×16384×4096   | row, row           |                      71.16 |               51.26 |                      1.39 |                      75.50 |                      1.47 |
| 4096×4096×16384   | col, col           |                      60.37 |               52.06 |                      1.16 |                      63.10 |                      1.21 |
| 4096×4096×16384   | row, col           |                      39.28 |               24.67 |                      1.59 |                      40.17 |                      1.63 |
| 4096×4096×16384   | col, row           |                      73.75 |               52.60 |                      1.40 |                      72.86 |                      1.39 |
| 4096×4096×16384   | row, row           |                      65.56 |               42.01 |                      1.56 |                      64.82 |                      1.54 |
| 2048×5120×5120    | col, col           |                      70.39 |               72.77 |                      0.97 |                      71.17 |                      0.98 |
| 2048×5120×5120    | row, col           |                      57.02 |               33.29 |                      1.71 |                      56.62 |                      1.70 |
| 2048×5120×5120    | col, row           |                      79.47 |               76.93 |                      1.03 |                      82.76 |                      1.08 |
| 2048×5120×5120    | row, row           |                      78.36 |               77.99 |                      1.00 |                      80.79 |                      1.04 |
| 4096×5120×5120    | col, col           |                      74.51 |               64.00 |                      1.16 |                      74.73 |                      1.17 |
| 4096×5120×5120    | row, col           |                      58.73 |               37.59 |                      1.56 |                      59.59 |                      1.59 |
| 4096×5120×5120    | col, row           |                      83.93 |               77.52 |                      1.08 |                      86.88 |                      1.12 |
| 4096×5120×5120    | row, row           |                      79.41 |               76.54 |                      1.04 |                      82.74 |                      1.08 |
| 32768×4096×4096   | col, col           |                      69.50 |               76.32 |                      0.91 |                      70.52 |                      0.92 |
| 32768×4096×4096   | row, col           |                      58.31 |               33.56 |                      1.74 |                      60.68 |                      1.81 |
| 32768×4096×4096   | col, row           |                      79.09 |               78.60 |                      1.01 |                      82.08 |                      1.04 |
| 32768×4096×4096   | row, row           |                      71.21 |               55.24 |                      1.29 |                      76.54 |                      1.39 |
| 65536×2048×2048   | col, col           |                      66.73 |               67.81 |                      0.98 |                      65.92 |                      0.97 |
| 65536×2048×2048   | row, col           |                      56.67 |               29.34 |                      1.93 |                      57.11 |                      1.95 |
| 65536×2048×2048   | col, row           |                      75.02 |               61.55 |                      1.22 |                      78.76 |                      1.28 |
| 65536×2048×2048   | row, row           |                      66.67 |               47.84 |                      1.39 |                      71.58 |                      1.50 |
