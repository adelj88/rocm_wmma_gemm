# Matrix Performance Benchmarks

Performance measured on AMD Radeon RX 7900 GRE on WSL2 (Ubuntu 24.04.1 LTS, ROCm 6.4.1) in TFLOPs.

## FP16-FP16 Performance Results

| Matrix Size       | Input Layout (A,B) | `rocm_wmma_gemm`<br>(C=col) | `rocBLAS`<br>(C=col) | Ratio<br>(C=col / rocBLAS) | `rocm_wmma_gemm`<br>(C=row) | Ratio<br>(C=row / rocBLAS) |
|:------------------|:-------------------|---------------------------:|--------------------:|--------------------------:|---------------------------:|--------------------------:|
| 4096×4096×1024    | col, col           |                      58.65 |               66.85 |                      0.88 |                      61.44 |                      0.92 |
| 4096×4096×1024    | row, col           |                      42.60 |               36.53 |                      1.17 |                      44.11 |                      1.21 |
| 4096×4096×1024    | col, row           |                      61.40 |               70.14 |                      0.88 |                      67.97 |                      0.97 |
| 4096×4096×1024    | row, row           |                      59.38 |               68.11 |                      0.87 |                      66.61 |                      0.98 |
| 8192×8192×1024    | col, col           |                      59.42 |               70.89 |                      0.84 |                      67.59 |                      0.95 |
| 8192×8192×1024    | row, col           |                      59.67 |               46.52 |                      1.28 |                      60.45 |                      1.30 |
| 8192×8192×1024    | col, row           |                      64.20 |               74.74 |                      0.86 |                      75.45 |                      1.01 |
| 8192×8192×1024    | row, row           |                      58.42 |               70.86 |                      0.82 |                      75.00 |                      1.06 |
| 4096×2048×64      | col, col           |                       9.67 |               12.14 |                      0.80 |                      11.78 |                      0.97 |
| 4096×2048×64      | row, col           |                       9.58 |               12.03 |                      0.80 |                      11.54 |                      0.96 |
| 4096×2048×64      | col, row           |                       9.59 |               12.24 |                      0.78 |                      11.35 |                      0.93 |
| 4096×2048×64      | row, row           |                       9.83 |               12.22 |                      0.80 |                      11.51 |                      0.94 |
| 8192×4096×128     | col, col           |                      27.96 |               43.18 |                      0.65 |                      38.21 |                      0.88 |
| 8192×4096×128     | row, col           |                      27.65 |               42.21 |                      0.66 |                      39.87 |                      0.94 |
| 8192×4096×128     | col, row           |                      28.60 |               43.15 |                      0.66 |                      41.64 |                      0.96 |
| 8192×4096×128     | row, row           |                      27.35 |               44.53 |                      0.61 |                      42.34 |                      0.95 |
| 4096×16384×4096   | col, col           |                      59.46 |               59.60 |                      1.00 |                      61.95 |                      1.04 |
| 4096×16384×4096   | row, col           |                      45.87 |               33.29 |                      1.38 |                      45.26 |                      1.36 |
| 4096×16384×4096   | col, row           |                      75.41 |               76.17 |                      0.99 |                      78.91 |                      1.04 |
| 4096×16384×4096   | row, row           |                      73.71 |               50.46 |                      1.46 |                      75.19 |                      1.49 |
| 4096×4096×16384   | col, col           |                      63.45 |               51.24 |                      1.24 |                      63.29 |                      1.24 |
| 4096×4096×16384   | row, col           |                      39.39 |               24.83 |                      1.59 |                      39.66 |                      1.60 |
| 4096×4096×16384   | col, row           |                      73.62 |               54.98 |                      1.34 |                      75.18 |                      1.37 |
| 4096×4096×16384   | row, row           |                      68.83 |               42.53 |                      1.62 |                      70.70 |                      1.66 |
| 2048×5120×5120    | col, col           |                      68.76 |               71.82 |                      0.96 |                      72.17 |                      1.00 |
| 2048×5120×5120    | row, col           |                      58.90 |               31.84 |                      1.85 |                      59.93 |                      1.88 |
| 2048×5120×5120    | col, row           |                      78.98 |               75.18 |                      1.05 |                      82.73 |                      1.10 |
| 2048×5120×5120    | row, row           |                      77.41 |               76.23 |                      1.02 |                      78.73 |                      1.03 |
| 4096×5120×5120    | col, col           |                      72.94 |               62.31 |                      1.17 |                      75.71 |                      1.22 |
| 4096×5120×5120    | row, col           |                      61.80 |               36.55 |                      1.69 |                      63.34 |                      1.73 |
| 4096×5120×5120    | col, row           |                      81.60 |               75.44 |                      1.08 |                      85.06 |                      1.13 |
| 4096×5120×5120    | row, row           |                      79.81 |               74.56 |                      1.07 |                      82.88 |                      1.11 |
| 32768×4096×4096   | col, col           |                      66.83 |               75.12 |                      0.89 |                      72.03 |                      0.96 |
| 32768×4096×4096   | row, col           |                      58.94 |               33.55 |                      1.76 |                      60.11 |                      1.79 |
| 32768×4096×4096   | col, row           |                      77.45 |               76.88 |                      1.01 |                      80.83 |                      1.05 |
| 32768×4096×4096   | row, row           |                      74.50 |               55.50 |                      1.34 |                      79.01 |                      1.42 |
| 65536×2048×2048   | col, col           |                      69.87 |               65.84 |                      1.06 |                      71.83 |                      1.09 |
| 65536×2048×2048   | row, col           |                      56.71 |               29.46 |                      1.92 |                      56.11 |                      1.90 |
| 65536×2048×2048   | col, row           |                      74.00 |               61.98 |                      1.19 |                      78.41 |                      1.27 |
| 65536×2048×2048   | row, row           |                      69.13 |               47.47 |                      1.46 |                      74.55 |                      1.57 |
