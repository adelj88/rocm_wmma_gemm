# Matrix Performance Benchmarks

Performance measured on AMD Radeon RX 7900 GRE on WSL2 (Ubuntu 24.04.1 LTS, ROCm 6.4.1) in TFLOPs.

| Matrix Size       | Input Layout (A,B) | `rocm_wmma_gemm`<br>(C=col) | `rocBLAS`<br>(C=col) | Ratio<br>(C=col / rocBLAS) | `rocm_wmma_gemm`<br>(C=row) | Ratio<br>(C=row / rocBLAS) |
|:------------------|:-------------------|---------------------------:|--------------------:|--------------------------:|---------------------------:|--------------------------:|
| 4096×4096×1024    | col, col           |                      60.94 |               66.21 |                      0.92 |                      62.63 |                      0.95 |
| 4096×4096×1024    | row, col           |                      42.74 |               34.81 |                      1.23 |                      44.47 |                      1.28 |
| 4096×4096×1024    | col, row           |                      60.93 |               70.21 |                      0.87 |                      68.00 |                      0.97 |
| 4096×4096×1024    | row, row           |                      60.70 |               68.30 |                      0.89 |                      65.73 |                      0.96 |
| 8192×8192×1024    | col, col           |                      62.57 |               71.32 |                      0.88 |                      65.80 |                      0.92 |
| 8192×8192×1024    | row, col           |                      58.91 |               46.73 |                      1.26 |                      60.65 |                      1.30 |
| 8192×8192×1024    | col, row           |                      68.52 |               75.00 |                      0.91 |                      74.75 |                      1.00 |
| 8192×8192×1024    | row, row           |                      58.91 |               70.72 |                      0.83 |                      73.76 |                      1.04 |
| 4096×2048×64      | col, col           |                       9.61 |               11.75 |                      0.82 |                      11.57 |                      0.98 |
| 4096×2048×64      | row, col           |                       9.32 |               11.62 |                      0.80 |                      11.57 |                      1.00 |
| 4096×2048×64      | col, row           |                       9.97 |               11.41 |                      0.87 |                      11.91 |                      1.04 |
| 4096×2048×64      | row, row           |                       9.48 |               11.57 |                      0.82 |                      11.75 |                      1.02 |
| 8192×4096×128     | col, col           |                      26.97 |               44.47 |                      0.61 |                      38.66 |                      0.87 |
| 8192×4096×128     | row, col           |                      28.16 |               41.04 |                      0.69 |                      38.09 |                      0.93 |
| 8192×4096×128     | col, row           |                      27.19 |               41.97 |                      0.65 |                      40.45 |                      0.96 |
| 8192×4096×128     | row, row           |                      27.86 |               42.82 |                      0.65 |                      42.14 |                      0.98 |
| 4096×16384×4096   | col, col           |                      58.86 |               55.38 |                      1.06 |                      65.92 |                      1.19 |
| 4096×16384×4096   | row, col           |                      45.61 |               30.44 |                      1.50 |                      45.12 |                      1.48 |
| 4096×16384×4096   | col, row           |                      74.97 |               76.45 |                      0.98 |                      78.01 |                      1.02 |
| 4096×16384×4096   | row, row           |                      69.65 |               47.94 |                      1.45 |                      72.19 |                      1.51 |
| 4096×4096×16384   | col, col           |                      63.30 |               48.18 |                      1.31 |                      62.98 |                      1.31 |
| 4096×4096×16384   | row, col           |                      41.81 |               22.75 |                      1.84 |                      41.92 |                      1.84 |
| 4096×4096×16384   | col, row           |                      73.22 |               47.82 |                      1.53 |                      74.82 |                      1.56 |
| 4096×4096×16384   | row, row           |                      70.06 |               38.80 |                      1.81 |                      69.62 |                      1.79 |
| 2048×5120×5120    | col, col           |                      65.24 |               69.91 |                      0.93 |                      70.55 |                      1.01 |
| 2048×5120×5120    | row, col           |                      58.49 |               30.50 |                      1.92 |                      59.94 |                      1.96 |
| 2048×5120×5120    | col, row           |                      78.84 |               75.51 |                      1.04 |                      82.54 |                      1.09 |
| 2048×5120×5120    | row, row           |                      77.71 |               75.45 |                      1.03 |                      80.85 |                      1.07 |
| 4096×5120×5120    | col, col           |                      72.92 |               58.96 |                      1.24 |                      75.95 |                      1.29 |
| 4096×5120×5120    | row, col           |                      61.52 |               34.38 |                      1.79 |                      63.26 |                      1.84 |
| 4096×5120×5120    | col, row           |                      81.55 |               75.66 |                      1.08 |                      84.74 |                      1.12 |
| 4096×5120×5120    | row, row           |                      77.13 |               74.22 |                      1.04 |                      80.14 |                      1.08 |
| 32768×4096×4096   | col, col           |                      66.46 |               74.49 |                      0.89 |                      71.31 |                      0.96 |
| 32768×4096×4096   | row, col           |                      58.39 |               30.60 |                      1.91 |                      59.52 |                      1.94 |
| 32768×4096×4096   | col, row           |                      76.54 |               76.72 |                      1.00 |                      80.31 |                      1.05 |
| 32768×4096×4096   | row, row           |                      71.78 |               52.76 |                      1.36 |                      75.85 |                      1.44 |
| 65536×2048×2048   | col, col           |                      70.00 |               65.17 |                      1.07 |                      71.46 |                      1.10 |
| 65536×2048×2048   | row, col           |                      51.34 |               26.66 |                      1.93 |                      54.01 |                      2.03 |
| 65536×2048×2048   | col, row           |                      73.51 |               56.03 |                      1.31 |                      78.61 |                      1.40 |
| 65536×2048×2048   | row, row           |                      64.70 |               46.38 |                      1.39 |                      71.43 |                      1.54 |
