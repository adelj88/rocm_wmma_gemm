# Matrix Performance Benchmarks

Performance measured on AMD Radeon RX 7900 GRE on WSL2 (Ubuntu 24.04.1 LTS, ROCm 6.3.4) in TFLOPs.

| Matrix Size       | Input Layout (A,B) | `rocm_wmma_gemm`<br>(C=col) | `rocBLAS`<br>(C=col) | Ratio<br>(C=col / rocBLAS) | `rocm_wmma_gemm`<br>(C=row) | Ratio<br>(C=row / rocBLAS) |
|:------------------|:-------------------|---------------------------:|--------------------:|--------------------------:|---------------------------:|--------------------------:|
| 4096×4096×1024    | col, col           |                      53.48 |               67.76 |                      0.79 |                      57.53 |                      0.85 |
| 4096×4096×1024    | row, col           |                      39.02 |               36.28 |                      1.08 |                      43.04 |                      1.19 |
| 4096×4096×1024    | col, row           |                      62.34 |               73.57 |                      0.85 |                      64.55 |                      0.88 |
| 4096×4096×1024    | row, row           |                      54.86 |               70.04 |                      0.78 |                      59.43 |                      0.85 |
| 8192×8192×1024    | col, col           |                      62.68 |               72.42 |                      0.87 |                      66.16 |                      0.91 |
| 8192×8192×1024    | row, col           |                      56.87 |               47.64 |                      1.19 |                      58.83 |                      1.24 |
| 8192×8192×1024    | col, row           |                      69.54 |               76.27 |                      0.91 |                      74.10 |                      0.97 |
| 8192×8192×1024    | row, row           |                      65.28 |               72.08 |                      0.91 |                      69.64 |                      0.97 |
| 4096×2048×64      | col, col           |                       8.28 |               11.42 |                      0.73 |                       9.93 |                      0.87 |
| 4096×2048×64      | row, col           |                       6.80 |               11.26 |                      0.60 |                       9.34 |                      0.83 |
| 4096×2048×64      | col, row           |                       8.06 |               11.59 |                      0.70 |                      10.55 |                      0.91 |
| 4096×2048×64      | row, row           |                       8.35 |               11.18 |                      0.75 |                      10.57 |                      0.95 |
| 8192×4096×128     | col, col           |                      26.30 |               41.88 |                      0.63 |                      36.27 |                      0.87 |
| 8192×4096×128     | row, col           |                      25.11 |               40.30 |                      0.62 |                      36.52 |                      0.91 |
| 8192×4096×128     | col, row           |                      26.74 |               40.96 |                      0.65 |                      38.48 |                      0.94 |
| 8192×4096×128     | row, row           |                      25.32 |               42.36 |                      0.60 |                      38.80 |                      0.92 |
| 4096×16384×4096   | col, col           |                      58.99 |               60.35 |                      0.98 |                      61.78 |                      1.02 |
| 4096×16384×4096   | row, col           |                      43.22 |               33.86 |                      1.28 |                      43.20 |                      1.28 |
| 4096×16384×4096   | col, row           |                      74.75 |               77.52 |                      0.96 |                      78.62 |                      1.01 |
| 4096×16384×4096   | row, row           |                      70.31 |               51.45 |                      1.37 |                      74.86 |                      1.46 |
| 4096×4096×16384   | col, col           |                      60.79 |               52.55 |                      1.16 |                      60.84 |                      1.16 |
| 4096×4096×16384   | row, col           |                      39.95 |               25.39 |                      1.57 |                      39.90 |                      1.57 |
| 4096×4096×16384   | col, row           |                      72.80 |               54.46 |                      1.34 |                      72.13 |                      1.32 |
| 4096×4096×16384   | row, row           |                      62.81 |               42.21 |                      1.49 |                      64.73 |                      1.53 |
| 2048×5120×5120    | col, col           |                      70.51 |               72.65 |                      0.97 |                      72.05 |                      0.99 |
| 2048×5120×5120    | row, col           |                      53.01 |               33.43 |                      1.59 |                      56.27 |                      1.68 |
| 2048×5120×5120    | col, row           |                      79.20 |               76.92 |                      1.03 |                      82.59 |                      1.07 |
| 2048×5120×5120    | row, row           |                      78.89 |               77.80 |                      1.01 |                      82.32 |                      1.06 |
| 4096×5120×5120    | col, col           |                      75.19 |               64.35 |                      1.17 |                      75.80 |                      1.18 |
| 4096×5120×5120    | row, col           |                      55.82 |               37.80 |                      1.48 |                      59.91 |                      1.59 |
| 4096×5120×5120    | col, row           |                      83.92 |               76.91 |                      1.09 |                      86.34 |                      1.12 |
| 4096×5120×5120    | row, row           |                      79.79 |               75.92 |                      1.05 |                      82.77 |                      1.09 |
| 32768×4096×4096   | col, col           |                      69.61 |               76.01 |                      0.92 |                      69.76 |                      0.92 |
| 32768×4096×4096   | row, col           |                      58.64 |               34.06 |                      1.72 |                      60.55 |                      1.78 |
| 32768×4096×4096   | col, row           |                      78.22 |               78.32 |                      1.00 |                      80.69 |                      1.03 |
| 32768×4096×4096   | row, row           |                      71.14 |               55.83 |                      1.27 |                      75.78 |                      1.36 |
| 65536×2048×2048   | col, col           |                      66.16 |               67.18 |                      0.98 |                      67.70 |                      1.01 |
| 65536×2048×2048   | row, col           |                      56.92 |               29.54 |                      1.93 |                      57.13 |                      1.93 |
| 65536×2048×2048   | col, row           |                      74.66 |               61.92 |                      1.21 |                      77.72 |                      1.26 |
| 65536×2048×2048   | row, row           |                      66.38 |               48.06 |                      1.38 |                      71.20 |                      1.48 |
