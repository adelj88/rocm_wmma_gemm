# Rectangle Matrix Performance Benchmarks

Performance measured on AMD Radeon RX 7900 GRE, Ubuntu 22.04.5 LTS, ROCm 6.4.2 in TFLOPs.

## FP16-FP16 Performance Results

| Matrix Size    | Input Layout (A,B) | `rocm_wmma_gemm`<br>(C=col) | `rocBLAS`<br>(C=col) | Ratio<br>(C=col / rocBLAS) | `rocm_wmma_gemm`<br>(C=row) | Ratio<br>(C=row / rocBLAS) |
|:---------------|:-------------------|---------------------------:|--------------------:|--------------------------:|---------------------------:|--------------------------:|
| 2048x5120x5120 | col, col |                      66.36 |               72.42 |                      0.92 |                      68.30 |                      0.94 |
| 2048x5120x5120 | row, col |                      60.07 |               33.41 |                      1.80 |                      61.95 |                      1.85 |
| 2048x5120x5120 | col, row |                      80.19 |               74.93 |                      1.07 |                      83.57 |                      1.12 |
| 2048x5120x5120 | row, row |                      81.11 |               76.14 |                      1.07 |                      82.82 |                      1.09 |
| 4096x2048x64 | col, col |                       9.96 |               12.23 |                      0.81 |                      10.65 |                      0.87 |
| 4096x2048x64 | row, col |                      10.01 |               12.36 |                      0.81 |                      10.42 |                      0.84 |
| 4096x2048x64 | col, row |                       9.84 |               12.38 |                      0.80 |                      11.17 |                      0.90 |
| 4096x2048x64 | row, row |                       9.66 |               11.85 |                      0.82 |                      11.99 |                      1.01 |
| 4096x4096x1024 | col, col |                      57.48 |               67.46 |                      0.85 |                      62.50 |                      0.93 |
| 4096x4096x1024 | row, col |                      44.66 |               37.18 |                      1.20 |                      46.82 |                      1.26 |
| 4096x4096x1024 | col, row |                      64.59 |               70.59 |                      0.92 |                      67.78 |                      0.96 |
| 4096x4096x1024 | row, row |                      59.92 |               68.22 |                      0.88 |                      67.85 |                      0.99 |
| 4096x4096x16384 | col, col |                      65.13 |               52.35 |                      1.24 |                      66.04 |                      1.26 |
| 4096x4096x16384 | row, col |                      42.00 |               25.21 |                      1.67 |                      41.66 |                      1.65 |
| 4096x4096x16384 | col, row |                      73.51 |               56.33 |                      1.31 |                      73.94 |                      1.31 |
| 4096x4096x16384 | row, row |                      69.84 |               42.30 |                      1.65 |                      71.23 |                      1.68 |
| 4096x5120x5120 | col, col |                      71.43 |               64.49 |                      1.11 |                      72.46 |                      1.12 |
| 4096x5120x5120 | row, col |                      67.43 |               37.75 |                      1.79 |                      70.67 |                      1.87 |
| 4096x5120x5120 | col, row |                      81.85 |               75.44 |                      1.08 |                      85.37 |                      1.13 |
| 4096x5120x5120 | row, row |                      82.18 |               74.57 |                      1.10 |                      84.37 |                      1.13 |
| 4096x16384x4096 | col, col |                      70.46 |               60.13 |                      1.17 |                      73.87 |                      1.23 |
| 4096x16384x4096 | row, col |                      51.24 |               33.85 |                      1.51 |                      51.58 |                      1.52 |
| 4096x16384x4096 | col, row |                      78.40 |               75.61 |                      1.04 |                      79.62 |                      1.05 |
| 4096x16384x4096 | row, row |                      69.74 |               50.49 |                      1.38 |                      73.51 |                      1.46 |
| 8192x4096x128 | col, col |                      32.42 |               45.58 |                      0.71 |                      38.29 |                      0.84 |
| 8192x4096x128 | row, col |                      32.45 |               42.63 |                      0.76 |                      39.33 |                      0.92 |
| 8192x4096x128 | col, row |                      31.89 |               43.13 |                      0.74 |                      40.31 |                      0.93 |
| 8192x4096x128 | row, row |                      27.73 |               44.31 |                      0.63 |                      42.49 |                      0.96 |
| 8192x8192x1024 | col, col |                      61.23 |               71.15 |                      0.86 |                      67.32 |                      0.95 |
| 8192x8192x1024 | row, col |                      57.72 |               46.93 |                      1.23 |                      60.28 |                      1.28 |
| 8192x8192x1024 | col, row |                      71.08 |               74.65 |                      0.95 |                      75.80 |                      1.02 |
| 8192x8192x1024 | row, row |                      59.11 |               70.76 |                      0.84 |                      74.82 |                      1.06 |
| 32768x4096x4096 | col, col |                      68.69 |               74.11 |                      0.93 |                      68.79 |                      0.93 |
| 32768x4096x4096 | row, col |                      54.09 |               33.13 |                      1.63 |                      52.84 |                      1.60 |
| 32768x4096x4096 | col, row |                      76.65 |               75.02 |                      1.02 |                      78.26 |                      1.04 |
| 32768x4096x4096 | row, row |                      74.19 |               54.94 |                      1.35 |                      78.00 |                      1.42 |
| 65536x2048x2048 | col, col |                      66.30 |               65.21 |                      1.02 |                      68.30 |                      1.05 |
| 65536x2048x2048 | row, col |                      53.16 |               29.06 |                      1.83 |                      53.44 |                      1.84 |
| 65536x2048x2048 | col, row |                      74.33 |               60.13 |                      1.24 |                      77.89 |                      1.30 |
| 65536x2048x2048 | row, row |                      68.37 |               46.56 |                      1.47 |                      74.84 |                      1.61 |