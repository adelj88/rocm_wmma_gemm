# Matrix Performance Benchmarks

Performance measured on AMD Radeon RX 7900 GRE on WSL2 (Ubuntu 24.04.1 LTS, ROCm 6.3.4) in TFLOPs.

| Matrix Size       | Input Layout (A,B) | `rocm_wmma_gemm`<br>(C=col) | `rocBLAS`<br>(C=col) | Ratio<br>(C=col / rocBLAS) | `rocm_wmma_gemm`<br>(C=row) | Ratio<br>(C=row / rocBLAS) |
|:------------------|:-------------------|---------------------------:|--------------------:|--------------------------:|---------------------------:|--------------------------:|
| 4096×4096×1024    | col, col           |                      53.35 |               67.84 |                      0.79 |                      54.25 |                      0.80 |
| 4096×4096×1024    | row, col           |                      38.28 |               34.59 |                      1.11 |                      42.08 |                      1.22 |
| 4096×4096×1024    | col, row           |                      59.79 |               72.32 |                      0.83 |                      63.68 |                      0.88 |
| 4096×4096×1024    | row, row           |                      53.71 |               66.22 |                      0.81 |                      58.27 |                      0.88 |
| 8192×8192×1024    | col, col           |                      62.38 |               71.65 |                      0.87 |                      65.57 |                      0.92 |
| 8192×8192×1024    | row, col           |                      56.31 |               47.21 |                      1.19 |                      58.26 |                      1.23 |
| 8192×8192×1024    | col, row           |                      70.17 |               76.26 |                      0.92 |                      74.25 |                      0.97 |
| 8192×8192×1024    | row, row           |                      64.87 |               71.58 |                      0.91 |                      69.48 |                      0.97 |
| 4096×2048×64      | col, col           |                       7.95 |                8.99 |                      0.88 |                       8.66 |                      0.96 |
| 4096×2048×64      | row, col           |                       8.19 |                8.81 |                      0.93 |                       8.00 |                      0.91 |
| 4096×2048×64      | col, row           |                       7.52 |                8.20 |                      0.92 |                       7.48 |                      0.91 |
| 4096×2048×64      | row, row           |                       8.08 |                7.58 |                      1.07 |                       7.65 |                      1.01 |
| 8192×4096×128     | col, col           |                      28.07 |               41.70 |                      0.67 |                      34.85 |                      0.84 |
| 8192×4096×128     | row, col           |                      29.41 |               33.04 |                      0.89 |                      30.93 |                      0.94 |
| 8192×4096×128     | col, row           |                      27.37 |               31.74 |                      0.86 |                      33.67 |                      1.06 |
| 8192×4096×128     | row, row           |                      28.65 |               36.20 |                      0.79 |                      34.74 |                      0.96 |
| 4096×16384×4096   | col, col           |                      59.36 |               55.26 |                      1.07 |                      61.91 |                      1.12 |
| 4096×16384×4096   | row, col           |                      42.13 |               30.29 |                      1.39 |                      41.98 |                      1.39 |
| 4096×16384×4096   | col, row           |                      74.37 |               77.76 |                      0.96 |                      79.39 |                      1.02 |
| 4096×16384×4096   | row, row           |                      70.43 |               48.04 |                      1.47 |                      74.65 |                      1.55 |
| 4096×4096×16384   | col, col           |                      59.99 |               48.31 |                      1.24 |                      58.30 |                      1.21 |
| 4096×4096×16384   | row, col           |                      36.78 |               22.78 |                      1.61 |                      37.54 |                      1.65 |
| 4096×4096×16384   | col, row           |                      73.76 |               47.16 |                      1.56 |                      72.75 |                      1.54 |
| 4096×4096×16384   | row, row           |                      64.88 |               38.58 |                      1.68 |                      64.26 |                      1.67 |
| 2048×5120×5120    | col, col           |                      69.86 |               69.68 |                      1.00 |                      69.97 |                      1.00 |
| 2048×5120×5120    | row, col           |                      54.82 |               30.45 |                      1.80 |                      52.96 |                      1.74 |
| 2048×5120×5120    | col, row           |                      79.58 |               77.09 |                      1.03 |                      81.65 |                      1.06 |
| 2048×5120×5120    | row, row           |                      78.27 |               75.38 |                      1.04 |                      78.77 |                      1.04 |
| 4096×5120×5120    | col, col           |                      74.63 |               58.89 |                      1.27 |                      74.99 |                      1.27 |
| 4096×5120×5120    | row, col           |                      54.01 |               34.17 |                      1.58 |                      57.92 |                      1.70 |
| 4096×5120×5120    | col, row           |                      84.16 |               77.53 |                      1.09 |                      86.39 |                      1.11 |
| 4096×5120×5120    | row, row           |                      80.22 |               75.75 |                      1.06 |                      82.59 |                      1.09 |
| 32768×4096×4096   | col, col           |                      69.94 |               75.10 |                      0.93 |                      69.15 |                      0.92 |
| 32768×4096×4096   | row, col           |                      54.21 |               30.64 |                      1.77 |                      55.54 |                      1.81 |
| 32768×4096×4096   | col, row           |                      78.88 |               78.10 |                      1.01 |                      80.29 |                      1.03 |
| 32768×4096×4096   | row, row           |                      71.14 |               52.82 |                      1.35 |                      76.03 |                      1.44 |
| 65536×2048×2048   | col, col           |                      66.58 |               65.81 |                      1.01 |                      67.61 |                      1.03 |
| 65536×2048×2048   | row, col           |                      52.83 |               26.64 |                      1.98 |                      52.22 |                      1.96 |
| 65536×2048×2048   | col, row           |                      74.55 |               55.72 |                      1.34 |                      78.65 |                      1.41 |
| 65536×2048×2048   | row, row           |                      66.19 |               46.28 |                      1.43 |                      71.10 |                      1.54 |
