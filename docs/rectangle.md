# Matrix Performance Benchmarks

Performance measured on AMD Radeon RX 7900 GRE on WSL2 (Ubuntu 24.04.1 LTS, ROCm 6.3.4) in TFLOPs.

| Matrix Size       | Input Layout (A,B) | `rocm_wmma_gemm`<br>(C=col) | `rocBLAS`<br>(C=col) | Ratio<br>(C=col / rocBLAS) | `rocm_wmma_gemm`<br>(C=row) | Ratio<br>(C=row / rocBLAS) |
|:------------------|:-------------------|---------------------------:|--------------------:|--------------------------:|---------------------------:|--------------------------:|
| 4096×4096×1024    | col, col           |                      48.50 |               68.71 |                      0.71 |                      49.20 |                      0.72 |
| 4096×4096×1024    | row, col           |                      39.18 |               34.89 |                      1.12 |                      40.28 |                      1.15 |
| 4096×4096×1024    | col, row           |                      53.69 |               74.89 |                      0.72 |                      57.00 |                      0.76 |
| 4096×4096×1024    | row, row           |                      48.22 |               69.41 |                      0.69 |                      51.94 |                      0.75 |
| 8192×8192×1024    | col, col           |                      63.19 |               72.40 |                      0.87 |                      66.02 |                      0.91 |
| 8192×8192×1024    | row, col           |                      57.39 |               47.35 |                      1.21 |                      59.19 |                      1.25 |
| 8192×8192×1024    | col, row           |                      70.67 |               76.91 |                      0.92 |                      74.62 |                      0.97 |
| 8192×8192×1024    | row, row           |                      64.94 |               71.92 |                      0.90 |                      68.37 |                      0.95 |
| 4096×2048×64      | col, col           |                       7.48 |               11.34 |                      0.66 |                       7.31 |                      0.64 |
| 4096×2048×64      | row, col           |                       7.70 |                9.49 |                      0.81 |                       8.13 |                      0.86 |
| 4096×2048×64      | col, row           |                       7.57 |               11.37 |                      0.67 |                       8.45 |                      0.74 |
| 4096×2048×64      | row, row           |                       7.05 |               11.27 |                      0.63 |                       9.46 |                      0.84 |
| 8192×4096×128     | col, col           |                      24.69 |               39.94 |                      0.62 |                      29.03 |                      0.73 |
| 8192×4096×128     | row, col           |                      24.48 |               35.51 |                      0.69 |                      30.02 |                      0.85 |
| 8192×4096×128     | col, row           |                      24.82 |               41.03 |                      0.60 |                      31.39 |                      0.76 |
| 8192×4096×128     | row, row           |                      23.95 |               42.58 |                      0.56 |                      32.47 |                      0.76 |
| 4096×16384×4096   | col, col           |                      48.42 |               60.44 |                      0.80 |                      49.40 |                      0.82 |
| 4096×16384×4096   | row, col           |                      42.07 |               33.76 |                      1.25 |                      41.90 |                      1.24 |
| 4096×16384×4096   | col, row           |                      75.38 |               78.21 |                      0.96 |                      79.46 |                      1.02 |
| 4096×16384×4096   | row, row           |                      71.13 |               50.90 |                      1.40 |                      73.61 |                      1.45 |
| 4096×4096×16384   | col, col           |                      61.74 |               52.42 |                      1.18 |                      57.71 |                      1.10 |
| 4096×4096×16384   | row, col           |                      39.72 |               25.10 |                      1.58 |                      40.52 |                      1.61 |
| 4096×4096×16384   | col, row           |                      69.12 |               51.63 |                      1.34 |                      70.27 |                      1.36 |
| 4096×4096×16384   | row, row           |                      63.42 |               41.15 |                      1.54 |                      63.42 |                      1.54 |
| 2048×5120×5120    | col, col           |                      71.70 |               73.16 |                      0.98 |                      70.24 |                      0.96 |
| 2048×5120×5120    | row, col           |                      51.26 |               33.18 |                      1.55 |                      51.92 |                      1.56 |
| 2048×5120×5120    | col, row           |                      81.96 |               77.40 |                      1.06 |                      84.40 |                      1.09 |
| 2048×5120×5120    | row, row           |                      77.21 |               78.57 |                      0.98 |                      80.20 |                      1.02 |
| 4096×5120×5120    | col, col           |                      77.00 |               63.73 |                      1.21 |                      74.22 |                      1.16 |
| 4096×5120×5120    | row, col           |                      60.20 |               37.50 |                      1.61 |                      60.61 |                      1.62 |
| 4096×5120×5120    | col, row           |                      84.71 |               77.27 |                      1.10 |                      87.38 |                      1.13 |
| 4096×5120×5120    | row, row           |                      81.07 |               77.16 |                      1.05 |                      82.40 |                      1.07 |
| 32768×4096×4096   | col, col           |                      71.39 |               76.38 |                      0.93 |                      69.50 |                      0.91 |
| 32768×4096×4096   | row, col           |                      58.99 |               33.70 |                      1.75 |                      60.65 |                      1.80 |
| 32768×4096×4096   | col, row           |                      78.77 |               77.34 |                      1.02 |                      80.75 |                      1.04 |
| 32768×4096×4096   | row, row           |                      70.81 |               55.32 |                      1.28 |                      74.41 |                      1.34 |
| 65536×2048×2048   | col, col           |                      66.96 |               67.84 |                      0.99 |                      66.47 |                      0.98 |
| 65536×2048×2048   | row, col           |                      56.86 |               29.43 |                      1.93 |                      57.34 |                      1.95 |
| 65536×2048×2048   | col, row           |                      74.60 |               62.00 |                      1.20 |                      78.30 |                      1.26 |
| 65536×2048×2048   | row, row           |                      66.32 |               47.58 |                      1.39 |                      69.96 |                      1.47 |