# Matrix Performance Benchmarks

Performance measured on AMD Radeon RX 7900 GRE on WSL2 (Ubuntu 24.04.1 LTS, ROCm 6.3.4) in TFLOPs.

| Matrix Size       | Input Layout (A,B) | `rocm_wmma_gemm`<br>(C=col) | `rocBLAS`<br>(C=col) | Ratio<br>(C=col / rocBLAS) | `rocm_wmma_gemm`<br>(C=row) | Ratio<br>(C=row / rocBLAS) |
|:------------------|:-------------------|---------------------------:|--------------------:|--------------------------:|---------------------------:|--------------------------:|
| 4096×4096×1024    | col, col           |                      53.18 |               65.93 |                      0.81 |                      55.08 |                      0.84 |
| 4096×4096×1024    | row, col           |                      39.16 |               36.01 |                      1.09 |                      40.31 |                      1.12 |
| 4096×4096×1024    | col, row           |                      60.80 |               72.54 |                      0.84 |                      63.72 |                      0.88 |
| 4096×4096×1024    | row, row           |                      53.91 |               66.63 |                      0.81 |                      58.59 |                      0.88 |
| 8192×8192×1024    | col, col           |                      62.85 |               71.76 |                      0.88 |                      66.61 |                      0.93 |
| 8192×8192×1024    | row, col           |                      56.68 |               48.19 |                      1.18 |                      59.04 |                      1.23 |
| 8192×8192×1024    | col, row           |                      69.58 |               77.22 |                      0.90 |                      74.14 |                      0.96 |
| 8192×8192×1024    | row, row           |                      65.97 |               72.37 |                      0.91 |                      69.91 |                      0.97 |
| 4096×2048×64      | col, col           |                       7.84 |                9.14 |                      0.86 |                       8.38 |                      0.92 |
| 4096×2048×64      | row, col           |                       7.72 |                9.19 |                      0.84 |                       8.58 |                      0.93 |
| 4096×2048×64      | col, row           |                       8.48 |                9.42 |                      0.90 |                       9.42 |                      1.00 |
| 4096×2048×64      | row, row           |                       7.71 |                9.30 |                      0.83 |                       8.51 |                      0.92 |
| 8192×4096×128     | col, col           |                      27.83 |               42.60 |                      0.65 |                      33.70 |                      0.79 |
| 8192×4096×128     | row, col           |                      29.19 |               33.22 |                      0.88 |                      34.81 |                      1.05 |
| 8192×4096×128     | col, row           |                      27.10 |               35.42 |                      0.77 |                      35.67 |                      1.01 |
| 8192×4096×128     | row, row           |                      28.38 |               41.90 |                      0.68 |                      35.74 |                      0.85 |
| 4096×16384×4096   | col, col           |                      47.53 |               60.05 |                      0.79 |                      47.20 |                      0.79 |
| 4096×16384×4096   | row, col           |                      42.07 |               33.43 |                      1.26 |                      43.29 |                      1.30 |
| 4096×16384×4096   | col, row           |                      75.44 |               78.50 |                      0.96 |                      80.16 |                      1.02 |
| 4096×16384×4096   | row, row           |                      70.89 |               50.37 |                      1.41 |                      75.64 |                      1.50 |
| 4096×4096×16384   | col, col           |                      61.20 |               52.06 |                      1.18 |                      61.32 |                      1.18 |
| 4096×4096×16384   | row, col           |                      39.82 |               24.97 |                      1.59 |                      40.41 |                      1.62 |
| 4096×4096×16384   | col, row           |                      70.75 |               51.43 |                      1.38 |                      72.87 |                      1.42 |
| 4096×4096×16384   | row, row           |                      65.17 |               42.11 |                      1.55 |                      64.17 |                      1.52 |
| 2048×5120×5120    | col, col           |                      70.02 |               72.94 |                      0.96 |                      70.63 |                      0.97 |
| 2048×5120×5120    | row, col           |                      52.32 |               32.96 |                      1.59 |                      55.35 |                      1.68 |
| 2048×5120×5120    | col, row           |                      80.70 |               76.65 |                      1.05 |                      81.99 |                      1.07 |
| 2048×5120×5120    | row, row           |                      76.96 |               77.76 |                      0.99 |                      81.12 |                      1.04 |
| 4096×5120×5120    | col, col           |                      74.91 |               64.04 |                      1.17 |                      75.06 |                      1.17 |
| 4096×5120×5120    | row, col           |                      59.60 |               37.50 |                      1.59 |                      59.08 |                      1.57 |
| 4096×5120×5120    | col, row           |                      84.01 |               79.50 |                      1.06 |                      87.04 |                      1.09 |
| 4096×5120×5120    | row, row           |                      79.86 |               78.42 |                      1.02 |                      82.37 |                      1.05 |
| 32768×4096×4096   | col, col           |                      69.85 |               76.46 |                      0.91 |                      70.28 |                      0.92 |
| 32768×4096×4096   | row, col           |                      57.96 |               33.30 |                      1.74 |                      59.58 |                      1.79 |
| 32768×4096×4096   | col, row           |                      78.92 |               77.93 |                      1.01 |                      80.81 |                      1.04 |
| 32768×4096×4096   | row, row           |                      71.65 |               55.44 |                      1.29 |                      76.14 |                      1.37 |
| 65536×2048×2048   | col, col           |                      66.37 |               67.73 |                      0.98 |                      67.54 |                      1.00 |
| 65536×2048×2048   | row, col           |                      56.83 |               29.05 |                      1.96 |                      56.64 |                      1.95 |
| 65536×2048×2048   | col, row           |                      75.54 |               60.81 |                      1.24 |                      78.72 |                      1.29 |
| 65536×2048×2048   | row, row           |                      66.73 |               47.40 |                      1.41 |                      71.39 |                      1.51 |
